mixins.crypto={data(){return{crypto:"",check:false}},methods:{SHA(t){return CryptoJS.SHA256(t).toString()},decrypt(t,e,r){try{let s=CryptoJS.AES.decrypt(t,e).toString(CryptoJS.enc.Utf8);return{check:this.SHA(s)===r,decrypted:s}}catch{return{check:false}}}},watch:{crypto(t){let e=this.$refs.crypto,r=this.$refs.content;let{decrypted:s,check:c}=this.decrypt(e.dataset.encrypted,t,e.dataset.shasum);this.check=c;if(c){e.classList.remove("fail");e.classList.add("success");e.disabled=true;r.innerHTML=s;this.render()}else e.classList.add("fail")}}};mixins.push(cryptoMixin);